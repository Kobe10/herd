<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="description" content="究竟谁能脱颖而出，摘得市级决赛的桂冠？" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="./style/home.css" />
  <title>《浙江诗词大会》市级决赛今日正式开赛！</title>
</head>

<body>
  <img id="imgForShare" style="position: fixed; left: -1000%; top: -1000%;"
    src="http://x0.ifengimg.com/cmpp/2020_31/eca1633215d8a82_size62_w300_h300.png" alt="分享缩略图" />
  <div id="ifeng_share_thumbnail" style="display:none"></div>
  <div id="ifeng_share_title" style="display:none"></div>
  <div id="ifeng_share_description" style="display:none"></div>
  <div id="ifeng_share_url" style="display:none"></div>
  <div class="content">
    <div class="content_2">
      <div class="con">
        <div class="con_tit bmmcx"></div>
        <div class="input_cont">
          <span class="tit_name">姓名</span>
          <input type="text" placeholder="请输入姓名" class="input_name_search">
        </div>
        <div class="input_cont">
          <span class="tit_name">电话</span>
          <input type="text" placeholder="请输入电话" class="input_phone_search">
        </div>
        <div class="submit">提交</div>
        <div class="search_ts">以上信息仅用于本次比赛</div>
      </div>
    </div>
  </div>
  <div class="tc"></div>
  <div class="back"></div>
</body>
<script src="https://p2.ifengimg.com/l/2018/27/61a49b087c93575/jquery-1.7.2.min.js"></script>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
  var shareIcon = document.getElementById('imgForShare').src,
    shareTitle = '《浙江诗词大会》市级决赛今日正式开赛！',
    shareContent = document.querySelector('meta[name=description]') ? document.querySelector('meta[name=description]')
    .getAttribute('content') : '究竟谁能脱颖而出，摘得市级决赛的桂冠？',
    shareLink = window.location.href;
  document.getElementById("ifeng_share_title").innerHTML = shareTitle;
  document.getElementById("ifeng_share_thumbnail").innerHTML = shareIcon;
  document.getElementById("ifeng_share_description").innerHTML = shareContent;
  document.getElementById("ifeng_share_url").innerHTML = shareLink;
  if (/MicroMessenger/.test(navigator.userAgent)) {
    var wxConfigParams = {};
    $.ajax({
      url: 'https://api.cmpp.v.ifeng.com/api/Secert',
      type: 'get',
      dataType: 'jsonp',
      data: {
        url: encodeURIComponent(window.location.href),
        _: '',
        rt: 'jsonp',
      },
      success: function (data) {
        wxConfigParams.debug = false;
        wxConfigParams.appId = data.data.appId;
        wxConfigParams.timestamp = data.data.timestamp;
        wxConfigParams.nonceStr = data.data.nonceStr;
        wxConfigParams.signature = data.data.signature;
        wxConfigParams.jsApiList = ['onMenuShareAppMessage', 'onMenuShareTimeline', 'onMenuShareQQ',
          'onMenuShareQZone'
        ];
        wx.config(wxConfigParams);
        wx.ready(function () {
          wx.onMenuShareAppMessage({
            title: shareTitle,
            desc: shareContent,
            link: shareLink,
            imgUrl: shareIcon
          });
          wx.onMenuShareQZone({
            title: shareTitle,
            desc: shareContent,
            link: shareLink,
            imgUrl: shareIcon
          });
          wx.onMenuShareQQ({
            title: shareTitle,
            desc: shareContent,
            link: shareLink,
            imgUrl: shareIcon
          });
          wx.onMenuShareTimeline({
            title: shareTitle,
            link: shareLink,
            imgUrl: shareIcon
          });
        });
      },
      error: function (data) {}
    });
  }
</script>
<script src="./scripts/common.js"></script>
<script>
  $(function () {
    //输入报名码
    var button_search = $('.button_search'),
      tc = $('.tc')
    button_search.click(function () {
      var input_search = $('.input_search').val();
      console.log(input_search)
      if (input_search.length == 0) {
        tc.show()
        tc.html('请输入正确的报名码')
        setTimeout(function () {
          tc.hide()
        }, 3000)
      }
    })

    //提交信息
    var submit = $('.submit');
    submit.click(function () {
      var input_name = $('.input_name_search').val().trim(),
        input_phone = $('.input_phone_search').val().trim();
      checkPhone(input_phone)
      if (!input_name.length || !input_name.length) {
        tc.show()
        tc.html('请填写完整的信息')
        setTimeout(function () {
          tc.hide()
        }, 3000)
      } else {
        $.ajax({
          url: host + "/api/apply/get/info",
          type: "post",
          contentType: "application/json",
          dataType: "JSON",
          data: JSON.stringify({
            "phone": input_phone,
            "userName": input_name //丹2   15275247911
          }),
          success: function (res) {
            if (res.code == 200) {
              sessionStorage.setItem('competitionCode', res.data.competitionCodeInfoVo.competitionCode)
              window.location.replace('./grsearch.shtml')
            } else {
              tc.show()
              tc.html(res.message)
              setTimeout(function () {
                tc.hide()
              }, 3000)
            }
          }
        })
      }
    })

    function keyUpFun() {
      if (isAndroid()) {
        const innerHeight = window.innerHeight;
        window.addEventListener('resize', () => {
          const newInnerHeight = window.innerHeight;
          if (innerHeight > newInnerHeight) {
            // 键盘弹出事件处理
            $('.submit').css("display", "none")

          } else {
            // 键盘收起事件处理
            //alert("android 键盘收起事件处理")
            $('.submit').css("display", "block")
            // $('.infoBg').css({
            //   "width": "86vw",
            //   "height": "92vh",
            //   "transform": "translate(7vw, 4vh)",
            //   "-webkit-transform": "translate(7vw, 4vh)",
            //   "margin-top": "auto"
            // })

          }
        });
      } else if (isIOS()) {
        console.log('ios机型')
        // window.addEventListener('focusin', () => {
        //   // 键盘弹出事件处理
        //   alert("iphone 键盘弹出事件处理")
        // });
        window.addEventListener('focusout', () => {
          window.scrollTo(0, 0)
          // 键盘收起事件处理

        });
      }
    }
    keyUpFun()

    $('.back').click(function () {
      history.go(-100)
      window.location.replace('./index_home.shtml')
    })

  })
</script>

</html>